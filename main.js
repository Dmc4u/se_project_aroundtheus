!function(){"use strict";const t=new class{constructor(t){this._baseUrl=t.baseUrl,this._headers=t.headers}_handleResponse(t){return t.ok?t.json():Promise.reject(`Error: ${t.status}`)}_request(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return fetch(`${this._baseUrl}${t}`,{headers:this._headers,...e}).then(this._handleResponse)}getUserInfo(){return this._request("/users/me")}updateUserInfo(t,e){return this._request("/users/me",{method:"PATCH",body:JSON.stringify({name:t,about:e})})}updateUserAvatar(t){return this._request("/users/me/avatar",{method:"PATCH",body:JSON.stringify({avatar:t})})}getInitialCards(){return this._request("/cards")}addCard(t,e){return this._request("/cards",{method:"POST",body:JSON.stringify({name:t,link:e})})}deleteCard(t){return this._request(`/cards/${t}`,{method:"DELETE"})}toggleLike(t,e){return this._request(`/cards/${t}/likes`,{method:e?"DELETE":"PUT"})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"6bf5193a-6919-4631-9825-3d61c0e57a1f","Content-Type":"application/json"}});var e=t;class s{constructor(t,e,s,r,n){let{name:i,link:o,_id:a,isLiked:l}=t;this._id=a,this._name=i,this._link=o,this._isLiked=l,this._cardSelector=e,this._handleImageClick=s,this._handleDeleteCard=r,this._handleLikeCard=n}getId(){return this._id}isLiked(){return this._isLiked}updateLikesView(t){this._isLiked=t,this._likeButton.classList.toggle("card__like-button_active",this._isLiked)}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeCard(this)})),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this,this._id)})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}generateCard(){return this._element=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._cardImage=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._element.querySelector(".card__title").textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this.updateLikesView(this._isLiked),this._setEventListeners(),this._element}removeCard(){this._element.remove(),this._element=null}}class r{constructor(t,e){if(this._settings=t,this._formElement=e,this._inputList=Array.from(this._formElement.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector),!this._buttonElement||0===this._inputList.length)throw new Error("FormValidator: Invalid form structure or missing elements.")}_showInputError(t,e){const s=this._formElement.querySelector(`#${t.id}-error`);s&&(t.classList.add(this._settings.inputErrorClass),s.textContent=e,s.classList.add(this._settings.errorClass))}_hideInputError(t){const e=this._formElement.querySelector(`#${t.id}-error`);e&&(t.classList.remove(this._settings.inputErrorClass),e.textContent="",e.classList.remove(this._settings.errorClass))}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}_toggleButtonState(){const t=this._inputList.some((t=>!t.validity.valid));this._buttonElement.disabled=t,this._buttonElement.classList.toggle(this._settings.inactiveButtonClass,t)}disableButton(){this._buttonElement.disabled=!0,this._buttonElement.classList.add(this._settings.inactiveButtonClass)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((t=>this._hideInputError(t)))}enableValidation(){this._setEventListeners()}}class n{constructor(t,e){let{renderer:s}=t;if("function"!=typeof s)throw new Error("Section: Renderer must be a valid function.");if(this._renderer=s,this._container=document.querySelector(e),!this._container)throw new Error(`Section: Container with selector "${e}" not found.`)}renderItems(t){if(!Array.isArray(t)||0===t.length)return void console.warn("Section: No valid items to render.");const e=document.createDocumentFragment();t.forEach((t=>{const s=this._renderer(t);s&&e.appendChild(s)})),this._container.appendChild(e)}addItem(t){t?this._container.prepend(t):console.error("Section: Cannot add an empty or undefined element.")}}class i{constructor(t){if(this._popup=document.querySelector(t),!this._popup)throw new Error(`Popup with selector "${t}" not found.`);this._boundHandleEscClose=this._handleEscClose.bind(this),this._confirmButton=this._popup.querySelector(".popup__confirm")}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._boundHandleEscClose),t&&(this._confirmAction=t)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._boundHandleEscClose),this._confirmAction=null}_handleEscClose(t){"Escape"===t.key&&this.close()}setEventListeners(){this._popup.addEventListener("click",(t=>{(t.target.classList.contains("popup_opened")||t.target.classList.contains("popup__close"))&&this.close()})),this._confirmButton&&this._confirmButton.addEventListener("click",(()=>{this._confirmAction&&(this._confirmAction(),this.close())}))}}class o extends i{constructor(t){if(super(t),this._popupImage=this._popup.querySelector(".popup__image"),this._popupCaption=this._popup.querySelector(".popup__caption"),!this._popupImage||!this._popupCaption)throw new Error(`PopupWithImage: Required elements not found in "${t}".`)}open(t){let{link:e,name:s}=t;this._popupImage.src=e,this._popupImage.alt=s,this._popupCaption.textContent=s,super.open()}}class a extends i{constructor(t,e){super(t),this._handleSubmit=e,this._form=this._popup.querySelector("form"),this._inputList=Array.from(this._form.querySelectorAll("input")),this._submitButton=this._form.querySelector(".popup__button"),this._defaultButtonText=this._submitButton.textContent}_getInputValues(){return this._inputList.reduce(((t,e)=>(t[e.name]=e.value,t)),{})}setInputValues(t){this._inputList.forEach((e=>{e.value=t[e.name]||""}))}_handleFormSubmit(t){t.preventDefault(),this._toggleLoadingState(!0);const e=this._getInputValues();console.log("Input data:",e);const s=this._handleSubmit(e);console.log("Submit result:",s),s&&"function"==typeof s.then?s.then((()=>this.close())).catch((t=>console.error("Error submitting form:",t))).finally((()=>{this._toggleLoadingState(!1)})):(console.error("Submit callback did not return a promise"),this._toggleLoadingState(!1))}_toggleLoadingState(t){this._submitButton.textContent=t?"Saving...":this._defaultButtonText,this._submitButton.disabled=t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",this._handleFormSubmit.bind(this))}resetForm(){this._form.reset()}close(){super.close(),this.resetForm()}}class l extends i{constructor(t){super(t),this._confirmButton=this._popup.querySelector(".popup__confirm"),this._handleSubmit=null}setSubmitAction(t){"function"==typeof t?this._handleSubmit=t:console.error("PopupWithConfirmation: setSubmitAction must be a function")}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(()=>{this._handleSubmit?(this._toggleLoadingState(!0),Promise.resolve(this._handleSubmit()).then((()=>this.close())).catch((t=>console.error("Error processing request:",t))).finally((()=>this._toggleLoadingState(!1)))):console.error("PopupWithConfirmation: No submit action set")}))}_toggleLoadingState(t){this._confirmButton.textContent=t?"Processing...":"Yes",this._confirmButton.disabled=t}}class u{constructor(t){let{nameSelector:e,aboutSelector:s,avatarSelector:r}=t;if(this._nameElement=document.querySelector(e),this._aboutElement=document.querySelector(s),this._avatarElement=document.querySelector(r),this._userId=null,!this._nameElement||!this._aboutElement||!this._avatarElement)throw new Error("UserInfo: One or more selectors are invalid.")}getUserId(){return this._userId}getUserInfo(){return{name:this._nameElement.textContent.trim(),about:this._aboutElement.textContent.trim(),avatar:this._avatarElement.src||"",userId:this._userId}}setUserInfo(t){let{name:e,about:s,avatar:r,_id:n}=t;"string"==typeof e&&e.trim()&&(this._nameElement.textContent=e),"string"==typeof s&&s.trim()&&(this._aboutElement.textContent=s),"string"==typeof r&&r.trim()&&this.setUserAvatar(r),n&&(this._userId=n)}setUserAvatar(t){"string"==typeof t&&t.trim()?this._avatarElement.src=t:console.warn("UserInfo: Invalid avatar URL.")}}const c={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelector("#edit-profile-button"),i=document.querySelector("#add-card-button"),d=document.querySelector("#change-profile-picture-button"),h=new u({nameSelector:".profile__title",aboutSelector:".profile__description",avatarSelector:".profile__image"}),_={},p=t=>{const e=new s(t,"#card-template",(t=>E.open(t)),(e=>f(e,t._id)),(()=>m(e)));return e.generateCard()},m=t=>{const s=t.isLiked();e.toggleLike(t.getId(),s).then((e=>{t.updateLikesView(e.isLiked)})).catch((t=>console.error(`Error updating like status: ${t}`)))},g=new l("#confirm-delete-popup");g.setEventListeners();const f=(t,s)=>{g.setSubmitAction((()=>e.deleteCard(s).then((()=>{t.removeCard(),g.close()})).catch((t=>console.error(`Error deleting card: ${t}`))))),g.open()},E=new o("#picture-popup");E.setEventListeners();const v=new a("#add-card-popup",(t=>e.addCard(t.name,t.link).then((t=>{S.addItem(p(t)),_["add-card-form"].disableButton(),v.close()})).catch((t=>console.error("Error adding card:",t)))));v.setEventListeners();const b=new a("#edit-profile-popup",(t=>e.updateUserInfo(t.name,t.about).then((t=>{h.setUserInfo(t),b.close()})).catch((t=>console.error("Error updating profile:",t)))));b.setEventListeners();const L=new a("#change-profile-picture-popup",(t=>e.updateUserAvatar(t.avatar).then((t=>{h.setUserAvatar(t.avatar),L.close()})).catch((t=>console.error("Error updating profile picture:",t)))));L.setEventListeners();const S=new n({renderer:t=>S.addItem(p(t))},".cards__list");var y;Promise.all([e.getUserInfo(),e.getInitialCards()]).then((t=>{let[e,s]=t;h.setUserInfo(e),h.setUserAvatar(e.avatar),S.renderItems(s.reverse())})).catch((t=>console.error("Error loading initial data:",t))),t.addEventListener("click",(()=>{b.setInputValues(h.getUserInfo()),_["edit-profile-form"].resetValidation(),b.open()})),i.addEventListener("click",(()=>{_["add-card-form"].resetValidation(),v.open()})),d.addEventListener("click",(()=>{_["change-profile-picture-form"].resetValidation(),L.open()})),y=c,document.querySelectorAll(y.formSelector).forEach((t=>{const e=new r(y,t);_[t.getAttribute("name")]=e,e.enableValidation()}))}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL2FwaS5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9hcm91bmQtdGhlLXVzLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vYXJvdW5kLXRoZS11cy8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL2Fyb3VuZC10aGUtdXMvLi9zcmMvcGFnZXMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gb3B0aW9ucy5iYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcclxuICB9XHJcblxyXG4gIF9oYW5kbGVSZXNwb25zZShyZXMpIHtcclxuICAgIHJldHVybiByZXMub2sgPyByZXMuanNvbigpIDogUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgfVxyXG5cclxuICBfcmVxdWVzdChlbmRwb2ludCwgb3B0aW9ucyA9IHt9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0ke2VuZHBvaW50fWAsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLi4ub3B0aW9ucyxcclxuICAgIH0pLnRoZW4odGhpcy5faGFuZGxlUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVVzZXJJbmZvKG5hbWUsIGFib3V0KSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGFib3V0IH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvdXNlcnMvbWUvYXZhdGFyXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyIH0pLFxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcIi9jYXJkc1wiKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQobmFtZSwgbGluaykge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCIvY2FyZHNcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IG5hbWUsIGxpbmsgfSksXHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgL2NhcmRzLyR7Y2FyZElkfWAsIHsgbWV0aG9kOiBcIkRFTEVURVwiIH0pO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlTGlrZShjYXJkSWQsIGlzTGlrZWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAvY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IGlzTGlrZWQgPyBcIkRFTEVURVwiIDogXCJQVVRcIixcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiNmJmNTE5M2EtNjkxOS00NjMxLTk4MjUtM2Q2MWMwZTU3YTFmXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFwaTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB7IG5hbWUsIGxpbmssIF9pZCwgaXNMaWtlZCB9LFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNhcmQsXHJcbiAgICBoYW5kbGVMaWtlQ2FyZFxyXG4gICkge1xyXG4gICAgdGhpcy5faWQgPSBfaWQ7IC8vIEVuc3VyZSBJRCBpcyBjb3JyZWN0bHkgYXNzaWduZWRcclxuICAgIHRoaXMuX25hbWUgPSBuYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGxpbms7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDsgLy8gU3RvcmUgaXNMaWtlZCBhcyBhIGJvb2xlYW5cclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuXHJcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNhcmQgPSBoYW5kbGVMaWtlQ2FyZDtcclxuICB9XHJcblxyXG4gIGdldElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkOyAvLyBFbnN1cmUgd2UgcmV0dXJuIGEgdmFsaWQgSURcclxuICB9XHJcblxyXG4gIGlzTGlrZWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDsgLy8gUmV0dXJuIGJvb2xlYW4gaXNMaWtlZCBzdGF0ZVxyXG4gIH1cclxuXHJcbiAgdXBkYXRlTGlrZXNWaWV3KGlzTGlrZWRGcm9tQVBJKSB7XHJcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZEZyb21BUEk7IC8vIFVwZGF0ZSBpbnRlcm5hbCBsaWtlIHN0YXRlXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXHJcbiAgICAgIFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIsXHJcbiAgICAgIHRoaXMuX2lzTGlrZWRcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDYXJkKHRoaXMpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQodGhpcywgdGhpcy5faWQpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZW5lcmF0ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX3RpdGxlXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFsdCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy51cGRhdGVMaWtlc1ZpZXcodGhpcy5faXNMaWtlZCk7IC8vIEVuc3VyZSBsaWtlIHN0YXRlIGlzIHJlZmxlY3RlZCBvbiBsb2FkXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZCgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7IC8vIFJlbW92ZXMgdGhlIGNhcmQgZWxlbWVudCBmcm9tIHRoZSBET01cclxuICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsOyAvLyBOdWxsaWZpZXMgdGhlIHJlZmVyZW5jZSB0byBlbnN1cmUgaXQncyBmdWxseSBjbGVhbmVkIHVwXHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX3NldHRpbmdzLmlucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yXHJcbiAgICApO1xyXG5cclxuICAgIGlmICghdGhpcy5fYnV0dG9uRWxlbWVudCB8fCB0aGlzLl9pbnB1dExpc3QubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICBcIkZvcm1WYWxpZGF0b3I6IEludmFsaWQgZm9ybSBzdHJ1Y3R1cmUgb3IgbWlzc2luZyBlbGVtZW50cy5cIlxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpZiAoIWVycm9yRWxlbWVudCkgcmV0dXJuO1xyXG5cclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlmICghZXJyb3JFbGVtZW50KSByZXR1cm47XHJcblxyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgY29uc3QgaGFzSW52YWxpZElucHV0ID0gdGhpcy5faW5wdXRMaXN0LnNvbWUoXHJcbiAgICAgIChpbnB1dCkgPT4gIWlucHV0LnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGhhc0ludmFsaWRJbnB1dDtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnRvZ2dsZShcclxuICAgICAgdGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyxcclxuICAgICAgaGFzSW52YWxpZElucHV0XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBpbnB1dC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XHJcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgaWYgKHR5cGVvZiByZW5kZXJlciAhPT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIlNlY3Rpb246IFJlbmRlcmVyIG11c3QgYmUgYSB2YWxpZCBmdW5jdGlvbi5cIik7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG5cclxuICAgIGlmICghdGhpcy5fY29udGFpbmVyKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICBgU2VjdGlvbjogQ29udGFpbmVyIHdpdGggc2VsZWN0b3IgXCIke2NvbnRhaW5lclNlbGVjdG9yfVwiIG5vdCBmb3VuZC5gXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcyhpdGVtcykge1xyXG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZW1zKSB8fCBpdGVtcy5sZW5ndGggPT09IDApIHtcclxuICAgICAgY29uc29sZS53YXJuKFwiU2VjdGlvbjogTm8gdmFsaWQgaXRlbXMgdG8gcmVuZGVyLlwiKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGZyYWdtZW50ID0gZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpO1xyXG5cclxuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgY29uc3QgZWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICBpZiAoZWxlbWVudCkge1xyXG4gICAgICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGVsZW1lbnQpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9jb250YWluZXIuYXBwZW5kQ2hpbGQoZnJhZ21lbnQpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICBpZiAoIWVsZW1lbnQpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIlNlY3Rpb246IENhbm5vdCBhZGQgYW4gZW1wdHkgb3IgdW5kZWZpbmVkIGVsZW1lbnQuXCIpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuXHJcbiAgICBpZiAoIXRoaXMuX3BvcHVwKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgUG9wdXAgd2l0aCBzZWxlY3RvciBcIiR7cG9wdXBTZWxlY3Rvcn1cIiBub3QgZm91bmQuYCk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5fYm91bmRIYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY29uZmlybVwiKTsgLy8gQWRkIGNvbmZpcm0gYnV0dG9uIHJlZmVyZW5jZVxyXG4gIH1cclxuXHJcbiAgb3Blbihjb25maXJtQWN0aW9uID0gbnVsbCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZChcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2JvdW5kSGFuZGxlRXNjQ2xvc2UpO1xyXG5cclxuICAgIC8vIFN0b3JlIGRlbGV0ZSBmdW5jdGlvbiBmb3IgbGF0ZXIgZXhlY3V0aW9uXHJcbiAgICBpZiAoY29uZmlybUFjdGlvbikge1xyXG4gICAgICB0aGlzLl9jb25maXJtQWN0aW9uID0gY29uZmlybUFjdGlvbjtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2JvdW5kSGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgdGhpcy5fY29uZmlybUFjdGlvbiA9IG51bGw7IC8vIFJlc2V0IGFjdGlvbiB0byBwcmV2ZW50IGFjY2lkZW50YWwgcmV1c2VcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZShldmVudCkge1xyXG4gICAgaWYgKGV2ZW50LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcclxuICAgICAgaWYgKFxyXG4gICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikgfHxcclxuICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfX2Nsb3NlXCIpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gSGFuZGxlIGNvbmZpcm0gYnV0dG9uIGNsaWNrXHJcbiAgICBpZiAodGhpcy5fY29uZmlybUJ1dHRvbikge1xyXG4gICAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NvbmZpcm1BY3Rpb24pIHtcclxuICAgICAgICAgIHRoaXMuX2NvbmZpcm1BY3Rpb24oKTsgLy8gRXhlY3V0ZSBzdG9yZWQgZGVsZXRlIGZ1bmN0aW9uXHJcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuXHJcbiAgICB0aGlzLl9wb3B1cEltYWdlID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9wb3B1cENhcHRpb24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jYXB0aW9uXCIpO1xyXG5cclxuICAgIGlmICghdGhpcy5fcG9wdXBJbWFnZSB8fCAhdGhpcy5fcG9wdXBDYXB0aW9uKSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihcclxuICAgICAgICBgUG9wdXBXaXRoSW1hZ2U6IFJlcXVpcmVkIGVsZW1lbnRzIG5vdCBmb3VuZCBpbiBcIiR7cG9wdXBTZWxlY3Rvcn1cIi5gXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBvcGVuKHsgbGluaywgbmFtZSB9KSB7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cENhcHRpb24udGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlU3VibWl0KSB7XHJcbiAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiZm9ybVwiKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiaW5wdXRcIikpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9kZWZhdWx0QnV0dG9uVGV4dCA9IHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDsgLy8gU3RvcmUgZGVmYXVsdCB0ZXh0XHJcbiAgfVxyXG5cclxuICAvLyBHZXQgZm9ybSBkYXRhXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5yZWR1Y2UoKHZhbHVlcywgaW5wdXQpID0+IHtcclxuICAgICAgdmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgIHJldHVybiB2YWx1ZXM7XHJcbiAgICB9LCB7fSk7XHJcbiAgfVxyXG5cclxuICAvLyBTZXQgaW5wdXQgdmFsdWVzIGR5bmFtaWNhbGx5XHJcbiAgc2V0SW5wdXRWYWx1ZXMoZGF0YSkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXSB8fCBcIlwiO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvLyBIYW5kbGUgZm9ybSBzdWJtaXNzaW9uIHdpdGggbG9hZGluZyBzdGF0ZVxyXG4gIF9oYW5kbGVGb3JtU3VibWl0KGV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgdGhpcy5fdG9nZ2xlTG9hZGluZ1N0YXRlKHRydWUpO1xyXG5cclxuICAgIGNvbnN0IGlucHV0RGF0YSA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIklucHV0IGRhdGE6XCIsIGlucHV0RGF0YSk7IC8vIERlYnVnZ2luZyBsb2dcclxuXHJcbiAgICBjb25zdCByZXN1bHQgPSB0aGlzLl9oYW5kbGVTdWJtaXQoaW5wdXREYXRhKTtcclxuICAgIGNvbnNvbGUubG9nKFwiU3VibWl0IHJlc3VsdDpcIiwgcmVzdWx0KTsgLy8gRGVidWdnaW5nIGxvZ1xyXG5cclxuICAgIGlmIChyZXN1bHQgJiYgdHlwZW9mIHJlc3VsdC50aGVuID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgcmVzdWx0XHJcbiAgICAgICAgLnRoZW4oKCkgPT4gdGhpcy5jbG9zZSgpKVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3Igc3VibWl0dGluZyBmb3JtOlwiLCBlcnIpKVxyXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX3RvZ2dsZUxvYWRpbmdTdGF0ZShmYWxzZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiU3VibWl0IGNhbGxiYWNrIGRpZCBub3QgcmV0dXJuIGEgcHJvbWlzZVwiKTtcclxuICAgICAgdGhpcy5fdG9nZ2xlTG9hZGluZ1N0YXRlKGZhbHNlKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8vIFRvZ2dsZSBidXR0b24gbG9hZGluZyBzdGF0ZVxyXG4gIF90b2dnbGVMb2FkaW5nU3RhdGUoaXNMb2FkaW5nKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBpc0xvYWRpbmdcclxuICAgICAgPyBcIlNhdmluZy4uLlwiXHJcbiAgICAgIDogdGhpcy5fZGVmYXVsdEJ1dHRvblRleHQ7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBpc0xvYWRpbmc7XHJcbiAgfVxyXG5cclxuICAvLyBTZXQgZXZlbnQgbGlzdGVuZXJzXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQuYmluZCh0aGlzKSk7XHJcbiAgfVxyXG5cclxuICAvLyBSZXNldCBmb3JtIGJlZm9yZSBjbG9zaW5nXHJcbiAgcmVzZXRGb3JtKCkge1xyXG4gICAgdGhpcy5fZm9ybS5yZXNldCgpO1xyXG4gIH1cclxuXHJcbiAgLy8gQ2xvc2UgdGhlIHBvcHVwXHJcbiAgY2xvc2UoKSB7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgdGhpcy5yZXNldEZvcm0oKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcihcIi5wb3B1cF9fY29uZmlybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IG51bGw7IC8vIEVuc3VyZSBhIGRlZmF1bHQgdmFsdWVcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgIGlmICh0eXBlb2YgYWN0aW9uID09PSBcImZ1bmN0aW9uXCIpIHtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0ID0gYWN0aW9uO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcclxuICAgICAgICBcIlBvcHVwV2l0aENvbmZpcm1hdGlvbjogc2V0U3VibWl0QWN0aW9uIG11c3QgYmUgYSBmdW5jdGlvblwiXHJcbiAgICAgICk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGlmICh0aGlzLl9oYW5kbGVTdWJtaXQpIHtcclxuICAgICAgICB0aGlzLl90b2dnbGVMb2FkaW5nU3RhdGUodHJ1ZSk7XHJcbiAgICAgICAgUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2hhbmRsZVN1Ym1pdCgpKVxyXG4gICAgICAgICAgLnRoZW4oKCkgPT4gdGhpcy5jbG9zZSgpKVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoXCJFcnJvciBwcm9jZXNzaW5nIHJlcXVlc3Q6XCIsIGVycikpXHJcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB0aGlzLl90b2dnbGVMb2FkaW5nU3RhdGUoZmFsc2UpKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKFwiUG9wdXBXaXRoQ29uZmlybWF0aW9uOiBObyBzdWJtaXQgYWN0aW9uIHNldFwiKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlTG9hZGluZ1N0YXRlKGlzTG9hZGluZykge1xyXG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IGlzTG9hZGluZyA/IFwiUHJvY2Vzc2luZy4uLlwiIDogXCJZZXNcIjtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24uZGlzYWJsZWQgPSBpc0xvYWRpbmc7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3RvciwgYWJvdXRTZWxlY3RvciwgYXZhdGFyU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9hYm91dEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGFib3V0U2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fdXNlcklkID0gbnVsbDsgLy8g4pyFIFN0b3JlIHVzZXIgSURcclxuXHJcbiAgICBpZiAoIXRoaXMuX25hbWVFbGVtZW50IHx8ICF0aGlzLl9hYm91dEVsZW1lbnQgfHwgIXRoaXMuX2F2YXRhckVsZW1lbnQpIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVXNlckluZm86IE9uZSBvciBtb3JlIHNlbGVjdG9ycyBhcmUgaW52YWxpZC5cIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvLyDinIUgTWV0aG9kIHRvIHJldHJpZXZlIHVzZXIgSURcclxuICBnZXRVc2VySWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fdXNlcklkO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudC50cmltKCksXHJcbiAgICAgIGFib3V0OiB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQudHJpbSgpLFxyXG4gICAgICBhdmF0YXI6IHRoaXMuX2F2YXRhckVsZW1lbnQuc3JjIHx8IFwiXCIsXHJcbiAgICAgIHVzZXJJZDogdGhpcy5fdXNlcklkLCAvLyDinIUgUmV0dXJuIHVzZXIgSURcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0LCBhdmF0YXIsIF9pZCB9KSB7XHJcbiAgICBpZiAodHlwZW9mIG5hbWUgPT09IFwic3RyaW5nXCIgJiYgbmFtZS50cmltKCkpIHtcclxuICAgICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgYWJvdXQgPT09IFwic3RyaW5nXCIgJiYgYWJvdXQudHJpbSgpKSB7XHJcbiAgICAgIHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0eXBlb2YgYXZhdGFyID09PSBcInN0cmluZ1wiICYmIGF2YXRhci50cmltKCkpIHtcclxuICAgICAgdGhpcy5zZXRVc2VyQXZhdGFyKGF2YXRhcik7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKF9pZCkge1xyXG4gICAgICB0aGlzLl91c2VySWQgPSBfaWQ7IC8vIOKchSBTdG9yZSB1c2VyIElEXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRVc2VyQXZhdGFyKGF2YXRhcikge1xyXG4gICAgaWYgKHR5cGVvZiBhdmF0YXIgPT09IFwic3RyaW5nXCIgJiYgYXZhdGFyLnRyaW0oKSkge1xyXG4gICAgICB0aGlzLl9hdmF0YXJFbGVtZW50LnNyYyA9IGF2YXRhcjtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIlVzZXJJbmZvOiBJbnZhbGlkIGF2YXRhciBVUkwuXCIpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZXR0aW5ncyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLnBvcHVwX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIucG9wdXBfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLnBvcHVwX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwicG9wdXBfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbiIsImltcG9ydCBhcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvYXBpLmpzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHNldHRpbmdzIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5cclxuZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtYnV0dG9uXCIpO1xyXG4gIGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWJ1dHRvblwiKTtcclxuICBjb25zdCBjaGFuZ2VQcm9maWxlUGljdHVyZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICBcIiNjaGFuZ2UtcHJvZmlsZS1waWN0dXJlLWJ1dHRvblwiXHJcbiAgKTtcclxuXHJcbiAgY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gICAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gICAgYWJvdXRTZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICAgIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxyXG4gIH0pO1xyXG5cclxuICBjb25zdCBmb3JtVmFsaWRhdG9ycyA9IHt9O1xyXG4gIGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpLmZvckVhY2goKGZvcm0pID0+IHtcclxuICAgICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtKTtcclxuICAgICAgZm9ybVZhbGlkYXRvcnNbZm9ybS5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpXSA9IHZhbGlkYXRvcjtcclxuICAgICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICAgIH0pO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0IGNyZWF0ZUNhcmQgPSAoY2FyZERhdGEpID0+IHtcclxuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcclxuICAgICAgY2FyZERhdGEsXHJcbiAgICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgICAgKGRhdGEpID0+IGltYWdlUG9wdXAub3BlbihkYXRhKSxcclxuICAgICAgKGNhcmRJbnN0YW5jZSkgPT4gaGFuZGxlRGVsZXRlQ2FyZChjYXJkSW5zdGFuY2UsIGNhcmREYXRhLl9pZCksXHJcbiAgICAgICgpID0+IGhhbmRsZUxpa2VDYXJkKGNhcmQpXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgaGFuZGxlTGlrZUNhcmQgPSAoY2FyZCkgPT4ge1xyXG4gICAgY29uc3QgaXNMaWtlZCA9IGNhcmQuaXNMaWtlZCgpO1xyXG4gICAgYXBpXHJcbiAgICAgIC50b2dnbGVMaWtlKGNhcmQuZ2V0SWQoKSwgaXNMaWtlZClcclxuICAgICAgLnRoZW4oKHVwZGF0ZWRDYXJkRGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmQudXBkYXRlTGlrZXNWaWV3KHVwZGF0ZWRDYXJkRGF0YS5pc0xpa2VkKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYEVycm9yIHVwZGF0aW5nIGxpa2Ugc3RhdHVzOiAke2Vycn1gKSk7XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY29uZmlybURlbGV0ZVBvcHVwID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNjb25maXJtLWRlbGV0ZS1wb3B1cFwiKTtcclxuICBjb25maXJtRGVsZXRlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgY29uc3QgaGFuZGxlRGVsZXRlQ2FyZCA9IChjYXJkLCBjYXJkSWQpID0+IHtcclxuICAgIGNvbmZpcm1EZWxldGVQb3B1cC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICByZXR1cm4gYXBpXHJcbiAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZElkKSAvLyBFbnN1cmUgdGhpcyByZXR1cm5zIGEgcHJvbWlzZVxyXG4gICAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xyXG4gICAgICAgICAgY29uZmlybURlbGV0ZVBvcHVwLmNsb3NlKCk7IC8vIE5vdyBpbiB0aGVuIGJsb2NrXHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihgRXJyb3IgZGVsZXRpbmcgY2FyZDogJHtlcnJ9YCkpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgY29uZmlybURlbGV0ZVBvcHVwLm9wZW4oKTtcclxuICB9O1xyXG5cclxuICBjb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3BpY3R1cmUtcG9wdXBcIik7XHJcbiAgaW1hZ2VQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICBjb25zdCBhZGRDYXJkUG9wdXBJbnN0YW5jZSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gICAgXCIjYWRkLWNhcmQtcG9wdXBcIixcclxuICAgIChpbnB1dERhdGEpID0+IHtcclxuICAgICAgcmV0dXJuIGFwaVxyXG4gICAgICAgIC5hZGRDYXJkKGlucHV0RGF0YS5uYW1lLCBpbnB1dERhdGEubGluaylcclxuICAgICAgICAudGhlbigobmV3Q2FyZCkgPT4ge1xyXG4gICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNyZWF0ZUNhcmQobmV3Q2FyZCkpO1xyXG4gICAgICAgICAgZm9ybVZhbGlkYXRvcnNbXCJhZGQtY2FyZC1mb3JtXCJdLmRpc2FibGVCdXR0b24oKTtcclxuICAgICAgICAgIGFkZENhcmRQb3B1cEluc3RhbmNlLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgYWRkaW5nIGNhcmQ6XCIsIGVycm9yKSk7XHJcbiAgICB9XHJcbiAgKTtcclxuICBhZGRDYXJkUG9wdXBJbnN0YW5jZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICBjb25zdCBwcm9maWxlRWRpdFBvcHVwSW5zdGFuY2UgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICAgIFwiI2VkaXQtcHJvZmlsZS1wb3B1cFwiLFxyXG4gICAgKGlucHV0RGF0YSkgPT4ge1xyXG4gICAgICByZXR1cm4gYXBpXHJcbiAgICAgICAgLnVwZGF0ZVVzZXJJbmZvKGlucHV0RGF0YS5uYW1lLCBpbnB1dERhdGEuYWJvdXQpXHJcbiAgICAgICAgLnRoZW4oKHVwZGF0ZWRVc2VyKSA9PiB7XHJcbiAgICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1cGRhdGVkVXNlcik7XHJcbiAgICAgICAgICBwcm9maWxlRWRpdFBvcHVwSW5zdGFuY2UuY2xvc2UoKTtcclxuICAgICAgICB9KVxyXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKFwiRXJyb3IgdXBkYXRpbmcgcHJvZmlsZTpcIiwgZXJyKSk7XHJcbiAgICB9XHJcbiAgKTtcclxuICBwcm9maWxlRWRpdFBvcHVwSW5zdGFuY2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgY29uc3QgY2hhbmdlUHJvZmlsZVBpY3R1cmVQb3B1cEluc3RhbmNlID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgICBcIiNjaGFuZ2UtcHJvZmlsZS1waWN0dXJlLXBvcHVwXCIsXHJcbiAgICAoaW5wdXREYXRhKSA9PiB7XHJcbiAgICAgIHJldHVybiBhcGlcclxuICAgICAgICAudXBkYXRlVXNlckF2YXRhcihpbnB1dERhdGEuYXZhdGFyKVxyXG4gICAgICAgIC50aGVuKCh1cGRhdGVkVXNlcikgPT4ge1xyXG4gICAgICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcih1cGRhdGVkVXNlci5hdmF0YXIpO1xyXG4gICAgICAgICAgY2hhbmdlUHJvZmlsZVBpY3R1cmVQb3B1cEluc3RhbmNlLmNsb3NlKCk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW5nIHByb2ZpbGUgcGljdHVyZTpcIiwgZXJyKSk7XHJcbiAgICB9XHJcbiAgKTtcclxuICBjaGFuZ2VQcm9maWxlUGljdHVyZVBvcHVwSW5zdGFuY2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgY29uc3Qgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gICAge1xyXG4gICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiBzZWN0aW9uLmFkZEl0ZW0oY3JlYXRlQ2FyZChjYXJkRGF0YSkpLFxyXG4gICAgfSxcclxuICAgIFwiLmNhcmRzX19saXN0XCJcclxuICApO1xyXG5cclxuICBQcm9taXNlLmFsbChbYXBpLmdldFVzZXJJbmZvKCksIGFwaS5nZXRJbml0aWFsQ2FyZHMoKV0pXHJcbiAgICAudGhlbigoW3VzZXJEYXRhLCBjYXJkRGF0YV0pID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZERhdGEucmV2ZXJzZSgpKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcihcIkVycm9yIGxvYWRpbmcgaW5pdGlhbCBkYXRhOlwiLCBlcnIpKTtcclxuXHJcbiAgcHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIHByb2ZpbGVFZGl0UG9wdXBJbnN0YW5jZS5zZXRJbnB1dFZhbHVlcyh1c2VySW5mby5nZXRVc2VySW5mbygpKTtcclxuICAgIGZvcm1WYWxpZGF0b3JzW1wiZWRpdC1wcm9maWxlLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICBwcm9maWxlRWRpdFBvcHVwSW5zdGFuY2Uub3BlbigpO1xyXG4gIH0pO1xyXG5cclxuICBhZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tcImFkZC1jYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgICBhZGRDYXJkUG9wdXBJbnN0YW5jZS5vcGVuKCk7XHJcbiAgfSk7XHJcblxyXG4gIGNoYW5nZVByb2ZpbGVQaWN0dXJlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBmb3JtVmFsaWRhdG9yc1tcImNoYW5nZS1wcm9maWxlLXBpY3R1cmUtZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxuICAgIGNoYW5nZVByb2ZpbGVQaWN0dXJlUG9wdXBJbnN0YW5jZS5vcGVuKCk7XHJcbiAgfSk7XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xyXG59KTtcclxuIl0sIm5hbWVzIjpbImFwaSIsImNvbnN0cnVjdG9yIiwib3B0aW9ucyIsInRoaXMiLCJfYmFzZVVybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfaGFuZGxlUmVzcG9uc2UiLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiX3JlcXVlc3QiLCJlbmRwb2ludCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImZldGNoIiwidGhlbiIsImdldFVzZXJJbmZvIiwidXBkYXRlVXNlckluZm8iLCJuYW1lIiwiYWJvdXQiLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsInVwZGF0ZVVzZXJBdmF0YXIiLCJhdmF0YXIiLCJnZXRJbml0aWFsQ2FyZHMiLCJhZGRDYXJkIiwibGluayIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJ0b2dnbGVMaWtlIiwiaXNMaWtlZCIsImF1dGhvcml6YXRpb24iLCJDYXJkIiwiX3JlZiIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDYXJkIiwiaGFuZGxlTGlrZUNhcmQiLCJfaWQiLCJfbmFtZSIsIl9saW5rIiwiX2lzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9oYW5kbGVMaWtlQ2FyZCIsImdldElkIiwidXBkYXRlTGlrZXNWaWV3IiwiaXNMaWtlZEZyb21BUEkiLCJfbGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsInRvZ2dsZSIsIl9zZXRFdmVudExpc3RlbmVycyIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnV0dG9uIiwiX2NhcmRJbWFnZSIsImdlbmVyYXRlQ2FyZCIsIl9lbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsInRleHRDb250ZW50Iiwic3JjIiwiYWx0IiwicmVtb3ZlQ2FyZCIsInJlbW92ZSIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJpbnB1dFNlbGVjdG9yIiwiX2J1dHRvbkVsZW1lbnQiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIkVycm9yIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJhZGQiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2hpZGVJbnB1dEVycm9yIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImhhc0ludmFsaWRJbnB1dCIsInNvbWUiLCJpbnB1dCIsImRpc2FibGVkIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImRpc2FibGVCdXR0b24iLCJmb3JFYWNoIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpc0FycmF5IiwiY29uc29sZSIsIndhcm4iLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJpdGVtIiwiZWxlbWVudCIsImFwcGVuZENoaWxkIiwiYWRkSXRlbSIsInByZXBlbmQiLCJlcnJvciIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9wb3B1cCIsIl9ib3VuZEhhbmRsZUVzY0Nsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsIl9jb25maXJtQnV0dG9uIiwib3BlbiIsImNvbmZpcm1BY3Rpb24iLCJfY29uZmlybUFjdGlvbiIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2ZW50Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEltYWdlIiwic3VwZXIiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cENhcHRpb24iLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlU3VibWl0IiwiX2hhbmRsZVN1Ym1pdCIsIl9mb3JtIiwiX3N1Ym1pdEJ1dHRvbiIsIl9kZWZhdWx0QnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsInJlZHVjZSIsInZhbHVlcyIsInZhbHVlIiwic2V0SW5wdXRWYWx1ZXMiLCJkYXRhIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJwcmV2ZW50RGVmYXVsdCIsIl90b2dnbGVMb2FkaW5nU3RhdGUiLCJpbnB1dERhdGEiLCJsb2ciLCJyZXN1bHQiLCJjYXRjaCIsImVyciIsImZpbmFsbHkiLCJpc0xvYWRpbmciLCJyZXNldEZvcm0iLCJyZXNldCIsIlBvcHVwV2l0aENvbmZpcm1hdGlvbiIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsInJlc29sdmUiLCJVc2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImFib3V0U2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9hYm91dEVsZW1lbnQiLCJfYXZhdGFyRWxlbWVudCIsIl91c2VySWQiLCJnZXRVc2VySWQiLCJ0cmltIiwidXNlcklkIiwic2V0VXNlckluZm8iLCJfcmVmMiIsInNldFVzZXJBdmF0YXIiLCJmb3JtU2VsZWN0b3IiLCJwcm9maWxlRWRpdEJ1dHRvbiIsImFkZENhcmRCdXR0b24iLCJjaGFuZ2VQcm9maWxlUGljdHVyZUJ1dHRvbiIsInVzZXJJbmZvIiwiZm9ybVZhbGlkYXRvcnMiLCJjcmVhdGVDYXJkIiwiY2FyZERhdGEiLCJjYXJkIiwiaW1hZ2VQb3B1cCIsImNhcmRJbnN0YW5jZSIsInVwZGF0ZWRDYXJkRGF0YSIsImNvbmZpcm1EZWxldGVQb3B1cCIsImFkZENhcmRQb3B1cEluc3RhbmNlIiwibmV3Q2FyZCIsInNlY3Rpb24iLCJwcm9maWxlRWRpdFBvcHVwSW5zdGFuY2UiLCJ1cGRhdGVkVXNlciIsImNoYW5nZVByb2ZpbGVQaWN0dXJlUG9wdXBJbnN0YW5jZSIsImNvbmZpZyIsImFsbCIsInVzZXJEYXRhIiwicmV2ZXJzZSIsImZvcm0iLCJ2YWxpZGF0b3IiLCJnZXRBdHRyaWJ1dGUiXSwic291cmNlUm9vdCI6IiJ9